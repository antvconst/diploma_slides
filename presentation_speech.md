### 1. Титульный слайд

Добрый день! Меня зовут Антон Константинов, и сегодня я бы хотел представить свою дипломную работу, посвящённую задаче оценивания геномного расстояния на графах де Брёйна.

### 2. Сборка генома

Под геномом мы будем понимать строку над четырёхбуквенным алфавитом, состоящим из символов A, C, G и T. Размеры геномов у различных биологических видов варьируются в достаточно широком диапазоне -- от нескольких сотен тысяч символов до ста пятидесяти миллиардов.

При этом до сих пор не существует метода, позволяющего прочитать весь геном сразу. Вместо этого из генома случайным образом считываются подстроки, называемые ридами, из которых геном затем требуется собрать воедино.

### 3. Граф де Брёйна

Одной из широко используемых структур данных, используемых для сборки геномов, является так называемый граф де Брёйна.

Здесь и далее k-мером некоторой строки мы будем называть её подстроку, имеющую длину k.

Графом де Брёйна строки S для некоторого натурального числа k мы будем называть направленный мультиграф, вершинами которого являются все её уникальные k-меры. Две его вершины u и v соединены ребром кратности N тогда и только тогда, когда S содержит N вхождений (k+1)-мера, имеющего префикс u и суффикс v.

То есть граф де Брёйна по своей сути состоит из всех уникальных подстрок генома длины k, которые соединены в том порядке, в котором они встречаются в геноме.

### 4. Сборка генома при помощи графа де Брёйна

Хорошо известно, что в графе де Брёйна, построенном по строке S существует эйлеров путь (то есть такой путь, который проходит по каждому его рёбру ровно столько раз, какова кратность этого ребра), который соответствует S.

В реальности строка S неизвестна, но есть набор её ридов. Соответственно, граф строится по k-мерам, полученным из этих ридов. При этом, если в полученном графе несколько эйлеровых путей, то совершенно непонятно, какой конкретно из них соответствует исходному геному. Таким образом, сборка генома при помощи графа сводится к поиску среди всех эйлеровых путей истинного геномного пути.

### 5. Проблема повторов

Одной из причин, которые приводят к неединственности эйлерова пути, являются повторы последовательностей длины не менее k. Они приводят к образованию в графе циклов.

Например, если мы добавим к строке из предыдущего примера всего один символ, то мы получим граф, состоящий из двух петель. Теперь становится непонятно, как должен проходить геномный путь -- сначала по верхней петле, затем по нижней, или наоборот?

К сожалению, ответить на этот вопрос только по графу в общем случае невозможно. Соответственно, требуется какая-то внешняя информация, которая помогла бы в этом.

### 6. Парные риды

Такую внешнюю информацию нам предоставят так называемые парные риды.

Рассмотрим независимые случайные величины xi, равномерно распределённую на множестве индексов генома, которая будет у нас играть роль координаты, и eta с произвольным распределением на положительной полуоси, которую мы будем называть длиной вставки.

Рассмотрим случайную подстроку генома от позиции xi до позиции xi + eta. Парным ридом мы будем называть пару из её первых и последних ell символов, которые мы будем называть левым и правым ридом соотвественно.

### 7. Парные риды как внешняя информация

Чем же нам помогут парные риды? Рассмотрим такую ситуацию, когда у нас есть парный рид r_1, r_2, и при этом r_1 и r_2 лежат на двух различных рёбрах e_1 и e_2. Обозначим через g расстояние между этими рёбрами внутри генома, через t -- расстояние от конца левого рида на левом ребре, а tau -- координату начала правого рида на правом ребре. Тогда все эти величины связаны через длину вставки eta. Следовательно, зная распределения eta, мы получаем внешнюю информацию о расстоянии между этими двумя рёбрами.

### 8. Постановка задачи

Итак, зафиксируем пару рёбер e_1, e_2. Предположим, что нам известны координаты вхождения этих рёбер в геном, и рассмотрим путь p в графе, который их соединяет. Тогда мы можем определить два расстояния между этими рёбрами -- одно расстояние вдоль рассматриваемого пути в графе, а другое -- внутри генома.

Как их соединяющих их путей, так и их вхождений в геном может быть много. Поэтому определим множества всех графовых расстояний и всех геномных расстояний между рассматриваемыми рёбрами.

Задача моей работы состояла в том, чтобы предложить алгоритм, который бы позволил при помощи набора (или библиотеки) ридов определить, какие из графовых расстояний являются также и геномными.

### 9. Вероятностный подход к задаче

Рассмотрим формально выборку из совместного распределения случайных величин t, tau и g. 

Мы можем это сделать только формально, так как реализации вектора t, tau наблюдаются только при условии того, что правый рид оказался подстрокой правого ребра (мы будем считать, что левый рид уже был приложен, и это учитывать не нужно), а реализации g являются скрытыми наблюдениями.

При этом мы можем считать, что распределение t, tau зависит от g как от параметра, а также мы знаем соотношение, связывающее t, tau с длиной вставки eta.

Итого мы получаем набор независимых реализаций вектора t, tau, а наша задача сводится к статистическому выводу для g по этому набору реализаций.

### 10. Апостериорное распределение для одной реализации

В ходе работы мной было получено при помощи байесовских методов аналитическое выражение для апостеорирного распределения g в условиях описанной модели.

Предполагалось, что известна функция распределения длины вставки. При этом на g было наложено в качестве априорного равномерное распределение на множестве всех графовых расстояний.

### 11. Переход к случаю нескольких реализаций

Однако, описанное апостериорное распределение подходит для случая ровно одной реализации вектора t, tau. На практике для каждого рида реализуется собственное значение параметра g, и поэтому нельзя напрямую сделать переход к повторной независимой выборке, как это обычно бывает в статистике.

Чтобы исправить это, мы можем слегка изменить модель, перейдя к смеси распределений с различными значениями g (благо их конечное число). Тогда нужную нам информацию будут содержать веса смеси, которые мы может оценить, усреднив апостериорные вероятности по всех реализациям вектора t, tau.

### 12. Данные

Полученный метод был протестирован на различных библиотеках ридов. Во всех тестах использовались первые четыреста тысяч нуклеотидов генома широко распространённого модельного организма -- кишечной палочки.

Эксперименты были проведены как на синтетических ридах с нормально распределённой длиной вставки (при разных значениях параметров), так и на реальных ридах. Были рассмотрены две библиотеки -- одна с практически идеально нормальным распределением длины вставки, вторая -- нет.

### 13. Пример: описание библиотеки

Рассмотрим вторую библиотеку и будем работать с ней в максимально приближенных к реальным условиях. В качестве функции распределения, требуемой для получения оценок, мы будем использовать эмпирическую ф. р., полученную по всем имеющимся ридам. 

### 14. Пример: рёбра без повторов


Рассмотрим пару весьма длинных рёбер графа, ни одно из которых не имеет повторов. На левой картинке представлена топология графа, стрелочки указывают на рассматриваемые рёбра, а на правой -- полученное апостериорное распределение, где красной полосой выделено единственное истинное расстояние. Как мы видим, оно имеет очень большую апостериорную вероятность.

### 15. Пример: повторное ребро

Теперь рассмотрим более интересный случай, когда одно ребро -- длинное и неповторное, а второе -- короткое и имеет тройную кратность. Как мы видим, и в этом случае метод также довольно успешно справляется с поставленной задачей.

### 16. Заключение

Таким образом, в работе была рассмотрена задача оценки геномных расстояний между рёбрами в графе де Брёйна, используемом при сборке геномов.

Мной была построена вероятностная модель, позволяющая получать требуемые оценки в виде апостериорных вероятностей для графовых расстояний. Построенная модель была протестирована как на синтетически, так и на реальных данных, и показала хорошие результаты.

В дальнейшем, предложенный метод может быть применён для улучшения разрешения повторов в геномных ассемблерах.

Спасибо за внимание!